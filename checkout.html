<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Checkout</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css" rel="stylesheet" />
   <link rel="stylesheet" href="style.css" />
  <style>
      @keyframes belokKiriLoop {
    0% { transform: translateX(0); }
    50% { transform: translateX(-6px); }
    100% { transform: translateX(0); }
  }

  .belok-loop {
    animation: belokKiriLoop 1.2s ease-in-out infinite;
  }
    .belok-loop {
      animation: belokKiriLoop 0.5s ease-in-out infinite;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">

<!-- Header -->
<header class="bg-white p-4 shadow-md flex items-center justify-between">
  <h1 class="text-xl font-bold">Checkout</h1>
<a href="index.html" class="btn-kembali">
  <i class="ri-arrow-left-line text-xl belok-loop"></i>
  <span>Kembali</span>
</a>

</header>

<!-- Konten lainnya... -->
<main class="flex-1 p-4 space-y-4" id="checkout-list"></main>

<section class="bg-white p-4 shadow-md rounded-t-xl">

<!-- Form Pembayaran -->
<div class="space-y-4 mb-6">

  <!-- Nama -->
  <div class="relative">
    <i class="ri-user-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-lg"></i>
    <input type="text" id="name" placeholder="Nama Lengkap" required
      class="w-full border pl-10 pr-4 py-2 rounded-md text-black font-semibold focus:outline-none focus:ring-2 focus:ring-blue-400" />
  </div>

  <!-- Alamat -->
  <div class="relative">
    <i class="ri-map-pin-line absolute left-3 top-3 text-gray-400 text-lg"></i>
    <textarea id="address" rows="3" placeholder="Alamat Lengkap" required
      class="w-full border pl-10 pr-4 py-2 rounded-md text-black font-semibold focus:outline-none focus:ring-2 focus:ring-blue-400 resize-none"></textarea>
  </div>

  <!-- Nomor HP -->
  <div class="relative">
    <i class="ri-phone-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-lg"></i>
    <input type="tel" id="phone" placeholder="Nomor HP / WhatsApp" required
      class="w-full border pl-10 pr-4 py-2 rounded-md text-black font-semibold focus:outline-none focus:ring-2 focus:ring-blue-400" />
  </div>

  <!-- Metode Pembayaran -->
  <div class="relative">
    <i class="ri-wallet-3-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-lg"></i>
    <select id="payment-method"
      class="w-full border pl-10 pr-4 py-2 rounded-md text-black font-semibold focus:outline-none focus:ring-2 focus:ring-blue-400">
      <option value="">Pilih Metode Pembayaran</option>
      <option value="transfer">Transfer Bank</option>
      <option value="cod">Cash on Delivery</option>
      <option value="qris">QRIS</option>
    </select>
  </div>


  <div class="flex justify-between text-lg font-semibold mb-4">
    <span>Total</span>
    <span id="total-price">Rp0</span>
  </div>

  <button id="pay-btn" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-6 rounded-md transition duration-300 w-full mb-14">
    Bayar Sekarang
  </button>


</section>

<script>
document.getElementById("pay-btn").addEventListener("click", () => {
  if (cart.length === 0) {
    alert("Keranjang kosong.");
    return;
  }

  const name = document.getElementById("name").value.trim();
  const address = document.getElementById("address").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const method = document.getElementById("payment-method").value;
  const note = document.getElementById("note").value.trim();

  if (!name || !address || !phone || !method) {
    alert("Mohon lengkapi semua data pembayaran.");
    return;
  }

  const history = JSON.parse(localStorage.getItem("history")) || [];
  history.push({
    items: cart,
    total: totalPriceElement.textContent,
    time: new Date().toLocaleString(),
    status: "Belum Dibayar",
    customer: {
      name,
      address,
      phone,
      method,
      note
    }
  });

  localStorage.setItem("history", JSON.stringify(history));
  localStorage.removeItem("checkout");
  alert("Pesanan berhasil disimpan. Kami akan menghubungi Anda segera.");
  window.location.href = "index.html";
});


  let cart = JSON.parse(localStorage.getItem('checkout')) || [];
  const checkoutList = document.getElementById('checkout-list');
  const totalPriceElement = document.getElementById('total-price');

  function updateTotal() {
    let total = 0;
    cart.forEach(item => {
      const price = parseInt(item.price.replace(/\D/g, '')) || 0;
      total += price * (item.qty || 1);
    });
    totalPriceElement.textContent = `Rp${total.toLocaleString('id-ID')}`;
  }

  function saveCart() {
    localStorage.setItem('checkout', JSON.stringify(cart));
    renderCart();
  }

  function renderCart() {
    checkoutList.innerHTML = '';
    if (cart.length === 0) {
      checkoutList.innerHTML = `<div class="text-center text-gray-500 mt-10">Keranjang kosong.</div>`;
      totalPriceElement.textContent = 'Rp0';
      return;
    }

    cart.forEach((item, index) => {
      const div = document.createElement('div');
      div.className = 'bg-white p-4 rounded-lg shadow flex items-center gap-4';

      div.innerHTML = `
        <img src="${item.image}" alt="${item.title}" class="w-20 h-20 object-cover rounded" />
        <div class="flex-1">
          <h3 class="text-md font-semibold">${item.title}</h3>
          <p class="text-sm text-gray-500">${item.desc}</p>
          <p class="text-orange-500 font-bold mt-1">${item.price}</p>
          <div class="flex items-center gap-2 mt-2">
            <button class="text-white bg-gray-400 hover:bg-gray-600 px-2 py-1 rounded" onclick="changeQty(${index}, -1)">-</button>
            <span class="px-3">${item.qty || 1}</span>
            <button class="text-white bg-gray-700 hover:bg-gray-900 px-2 py-1 rounded" onclick="changeQty(${index}, 1)">+</button>
          </div>
        </div>
        <button onclick="removeItem(${index})" class="text-red-500 hover:text-red-700"><i class="ri-delete-bin-line text-xl"></i></button>
      `;
      checkoutList.appendChild(div);
    });

    updateTotal();
  }

  function changeQty(index, delta) {
    cart[index].qty = (cart[index].qty || 1) + delta;
    if (cart[index].qty <= 0) {
      cart.splice(index, 1);
    }
    saveCart();
  }

  function removeItem(index) {
    cart.splice(index, 1);
    saveCart();
  }

  document.getElementById("pay-btn").addEventListener("click", () => {
    if (cart.length === 0) {
      alert("Keranjang kosong.");
      return;
    }

    const history = JSON.parse(localStorage.getItem("history")) || [];
    history.push({
      items: cart,
      total: totalPriceElement.textContent,
      time: new Date().toLocaleString(),
      status: "Belum Dibayar"
    });

    localStorage.setItem("history", JSON.stringify(history));
    localStorage.removeItem("checkout");
    alert("Pembayaran berhasil. Terima kasih!");
    window.location.href = "index.html";
  });

  renderCart();
</script>

</body>
</html>
