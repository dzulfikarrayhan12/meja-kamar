<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Checkout</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css" rel="stylesheet" />
  <style>
      @keyframes belokKiriLoop {
    0% { transform: translateX(0); }
    50% { transform: translateX(-6px); }
    100% { transform: translateX(0); }
  }

  .belok-loop {
    animation: belokKiriLoop 1.2s ease-in-out infinite;
  }
    .belok-loop {
      animation: belokKiriLoop 0.5s ease-in-out infinite;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">

<!-- Header -->
<header class="bg-white p-4 shadow-md flex items-center justify-between">
  <h1 class="text-xl font-bold">Checkout</h1>
  <a href="index.html" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md shadow-md flex items-center gap-2">
    <i class="ri-arrow-left-line text-xl belok-loop"></i>
    <span>Kembali</span>
  </a>
</header>

<!-- Konten lainnya... -->
<main class="flex-1 p-4 space-y-4" id="checkout-list"></main>

<section class="bg-white p-4 shadow-md rounded-t-xl">
  <div class="flex justify-between text-lg font-semibold mb-4">
    <span>Total</span>
    <span id="total-price">Rp0</span>
  </div>
  <button id="pay-btn" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-6 rounded-md transition duration-300 w-full mb-14">
    Bayar Sekarang
  </button>
</section>

<script>
  let cart = JSON.parse(localStorage.getItem('checkout')) || [];
  const checkoutList = document.getElementById('checkout-list');
  const totalPriceElement = document.getElementById('total-price');

  function updateTotal() {
    let total = 0;
    cart.forEach(item => {
      const price = parseInt(item.price.replace(/\D/g, '')) || 0;
      total += price * (item.qty || 1);
    });
    totalPriceElement.textContent = `Rp${total.toLocaleString('id-ID')}`;
  }

  function saveCart() {
    localStorage.setItem('checkout', JSON.stringify(cart));
    renderCart();
  }

  function renderCart() {
    checkoutList.innerHTML = '';
    if (cart.length === 0) {
      checkoutList.innerHTML = `<div class="text-center text-gray-500 mt-10">Keranjang kosong.</div>`;
      totalPriceElement.textContent = 'Rp0';
      return;
    }

    cart.forEach((item, index) => {
      const div = document.createElement('div');
      div.className = 'bg-white p-4 rounded-lg shadow flex items-center gap-4';

      div.innerHTML = `
        <img src="${item.image}" alt="${item.title}" class="w-20 h-20 object-cover rounded" />
        <div class="flex-1">
          <h3 class="text-md font-semibold">${item.title}</h3>
          <p class="text-sm text-gray-500">${item.desc}</p>
          <p class="text-orange-500 font-bold mt-1">${item.price}</p>
          <div class="flex items-center gap-2 mt-2">
            <button class="text-white bg-gray-400 hover:bg-gray-600 px-2 py-1 rounded" onclick="changeQty(${index}, -1)">-</button>
            <span class="px-3">${item.qty || 1}</span>
            <button class="text-white bg-gray-700 hover:bg-gray-900 px-2 py-1 rounded" onclick="changeQty(${index}, 1)">+</button>
          </div>
        </div>
        <button onclick="removeItem(${index})" class="text-red-500 hover:text-red-700"><i class="ri-delete-bin-line text-xl"></i></button>
      `;
      checkoutList.appendChild(div);
    });

    updateTotal();
  }

  function changeQty(index, delta) {
    cart[index].qty = (cart[index].qty || 1) + delta;
    if (cart[index].qty <= 0) {
      cart.splice(index, 1);
    }
    saveCart();
  }

  function removeItem(index) {
    cart.splice(index, 1);
    saveCart();
  }

  document.getElementById("pay-btn").addEventListener("click", () => {
    if (cart.length === 0) {
      alert("Keranjang kosong.");
      return;
    }

    const history = JSON.parse(localStorage.getItem("history")) || [];
    history.push({
      items: cart,
      total: totalPriceElement.textContent,
      time: new Date().toLocaleString(),
      status: "Belum Dibayar"
    });

    localStorage.setItem("history", JSON.stringify(history));
    localStorage.removeItem("checkout");
    alert("Pembayaran berhasil. Terima kasih!");
    window.location.href = "index.html";
  });

  renderCart();
</script>

</body>
</html>
